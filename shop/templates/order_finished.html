<!DOCTYPE html>
<html lang='pl'>
<head>
    <meta charset="UTF-8">
    <title>Podsumowanie zamówienia</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/list_style.css' %}">
    <link rel="stylesheet" href="{% static 'css/form_style.css' %}">
</head>
<body>
<div>
    {% include 'login_logout_links.html' %}
    {% include 'links.html' %}

     <div class="corner-box">
    <h1 class="date-corner">Dzisiaj {{ current_date }}</h1>
    </div>

</div>

<div class="honey-table-container">
    <h2 style="margin-bottom: 18px; text-align: center;">PODSUMOWANIE ZAMÓWIENIA</h2>
    <h3>Co zamówiłeś:</h3>
    <table class="honey-table">
        <tr>
            <th>#</th>
            <th>Produkt/Miód</th>
            <th>Ilość</th>
            <th>Cena</th>
            <th>Łącznie</th>
        </tr>
        {% for item in order_items %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ item.product_name }}</td>
                <td>{{ item.quantity }}</td>
                <td>{{ item.price|floatformat:2 }} PLN</td>
                <td>{{ item.total_line_price }} PLN</td>
            </tr>
        {% endfor %}
        <tr>
            <td colspan="4" style="text-align:right;"><strong>Całkowity koszt:</strong></td>
            <td><strong>{{ order.total_price }} PLN</strong></td>
        </tr>
    </table>

    <hr style="margin: 30px 0;">

    <h3>Dane do wysyłki:</h3>
    <div class="order-data-summary">
        <p>
            <strong>Imię i nazwisko:</strong> {{ order.first_name }} {{ order.last_name }}<br>
            <strong>E-mail:</strong> {{ order.email }}<br>
            <strong>Telefon:</strong> {{ order.phone_number }}<br>
            <strong>Miejscowość:</strong> {{ order.post_code }} {{ order.city }}<br>
            <strong>Adres:</strong> {{ order.street }} {{ order.street_number }}{% if order.door_number %}/{{ order.door_number }}{% endif %}
        </p>
    </div>

    <div style="text-align: center; margin-top: 30px;">
        <a href="{% url 'shop_products' %}" class="btn-link3">Wróć do sklepu</a>
        {% if not order.paid %}
            <form method="post" action="{% url 'stripe_checkout' order.id %}">
                {% csrf_token %}
                <button type="submit">Zapłać teraz przez Stripe</button>
            </form>
        {% else %}
            <div style="display: flex; flex-direction: column; align-items: center; margin-top: 20px;">
                <div style="
            background: #4BB543;
            color: white;
            width: 64px;
            height: 64px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            box-shadow: 0 2px 8px #4bb54333;
        ">
                    &#10003;
                </div>
                <p style="
            color: #388d37;
            font-size: 1.2em;
            font-weight: bold;
            margin-top: 0;
        ">
                    Zamówienie opłacone. Dziękujemy!
                </p>
            </div>
        {% endif %}
    </div>
</div>
</body>
</html>